<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>学生一覧</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <style>
      table {
        border-collapse: collapse;
      }
      td,
      th {
        border: 1px solid #ccc;
        padding: 0.4rem 0.6rem;
      }
    </style>
  </head>
  <body>
    <header class="appbar">
      <div class="appbar-title">学生一覧</div>
      <nav class="appbar-nav">
        <a th:href="@{/}">ホーム</a>
        <a th:href="@{/students/new}">新規登録</a>
      </nav>
    </header>
    <main class="container">
      <div class="card">
        <form class="row" method="get" th:action="@{/students}" style="margin-bottom: 0.5rem">
          <div class="input-field" style="flex: 1">
            <input type="text" name="q" th:value="${q}" placeholder="氏名・学籍番号で検索" />
          </div>
          <button class="btn" type="submit">検索</button>
          <a class="btn outlined" th:href="@{/students}">クリア</a>
        </form>
        <table class="table">
          <thead>
            <tr>
              <th>ID</th>
              <th>
                <a
                  th:href="@{/students(q=${q}, classId=${classId}, page=0, size=${students.size}, sort='studentNumber,asc')}"
                  >学籍番号</a
                >
              </th>
              <th>
                <a
                  th:href="@{/students(q=${q}, classId=${classId}, page=0, size=${students.size}, sort='name,asc')}"
                  >氏名</a
                >
              </th>
              <th>所属クラス</th>
              <th>状態</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="s : ${students.content}">
              <td th:text="${s.id}"></td>
              <td th:text="${s.studentNumber}"></td>
              <td th:text="${s.name}"></td>
              <td th:text="${s.schoolClass != null ? s.schoolClass.name : '-'}"></td>
              <td th:text="${s.active} ? '在籍' : '退席'"></td>
              <td>
                <a th:href="@{|/students/${s.id}/edit|}">編集</a>
                <form
                  th:action="@{|/students/${s.id}/delete|}"
                  method="post"
                  style="display: inline"
                  onsubmit="return confirm('削除しますか？')"
                >
                  <button type="submit">削除</button>
                </form>
              </td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="6">
                <div th:text="${students.totalElements} + ' 名'">0 名</div>
                <div>
                  <a
                    th:if="${students.hasPrevious()}"
                    th:href="@{/students(q=${q}, classId=${classId}, page=${students.number-1}, size=${students.size}, sort=${students.sort})}"
                    >前へ</a
                  >
                  <span th:text="${students.number + 1}"></span>/<span
                    th:text="${students.totalPages}"
                  ></span>
                  <a
                    th:if="${students.hasNext()}"
                    th:href="@{/students(q=${q}, classId=${classId}, page=${students.number+1}, size=${students.size}, sort=${students.sort})}"
                    >次へ</a
                  >
                </div>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </main>
    <script defer th:src="@{/js/app.js}"></script>
  </body>
</html>
